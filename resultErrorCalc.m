%% indoor refernce path
marker = [0, 0;0,1.2;0, 2.4;0, 3.6;0, 4.8;0, 6.0;0, 7.2;0, 8.4;0, 9.6;
    -1.2, 9.6;
    -2.4, 9.6;-2.4, 8.4;-2.4,7.2;-2.4,6.0;-2.4,4.8;-2.4,3.6;-2.4, 2.4;-2.4, 1.2;-2.4, 0;
    -1.2, 0;0, 0];

%% outdoor refernce path
marker_raw = [24.83238366 60.18848754 46.61;
24.83219484 60.18851366 45.81;
24.83199405 60.18852637 45.11;
24.83181204 60.18854885 44.73;
24.83161365 60.18855658 44.39;
24.83141676 60.18855409 44.14;
24.83122447 60.18856188 43.91;
24.83103933 60.18855694 43.72;
24.8308525 60.18854706 43.57;
24.83063923 60.18854531 43.41;
24.8307139 60.18845093 43.21;
24.83078513 60.188358 43.1;
24.83086895 60.18826934 43.02;
24.83096445 60.18819088 42.95;
24.83105774 60.18810842 42.89;
24.83115505 60.1880243 42.85;
24.83125339 60.18793932 42.85;
24.83133837 60.1878581 42.86;
24.83143197 60.18777665 42.87;
24.83154796 60.18770667 42.86;
24.83168821 60.18764653 42.83;
24.83181863 60.18758187 42.76;
24.83200271 60.18755098 42.69;
24.83216777 60.18748939 42.59;
24.83220419 60.18739852 42.51;
24.83223951 60.18730685 42.39;
24.83242306 60.18728235 42.26;
24.83257887 60.1873352 42.16;
24.83271932 60.1874012 42.05;
24.83285666 60.18746327 41.95;
24.83299301 60.18754325 41.81;
24.83309587 60.18763624 41.68;
24.83317183 60.18772209 41.6;
24.83323092 60.18780853 41.51;
24.83329481 60.18790721 41.41;
24.83335337 60.18800374 41.32;
24.83341458 60.188101 41.25;
24.83348361 60.18818948 41.18;
24.83355697 60.18827243 41.12;
24.83362344 60.18836311 41.04;
24.83369149 60.18844637 40.95;
24.83352041 60.18848911 40.84;
24.83334096 60.18850233 40.74;
24.83315256 60.18850662 40.66;
24.83295181 60.1885148 40.54;
24.83275661 60.18850302 40.45;
24.83258264 60.18847351 40.35;
24.83239092 60.18848872 40.24;];

marker_blh = [marker_raw(:,2)*glv.rad marker_raw(:,1)*glv.rad zeros(length(marker_raw),1)+5];

marker0 = zeros(length(marker_blh),3);

for i = 1:length(marker_blh)
    marker0(i,:) = blh2xyz(marker_blh(i,:))';
end

marker = marker0 - marker0(1,:);


%%
figure;hold on
plot(marker(:,1),marker(:,2),'-*')
plot(marker(1,1),marker(1,2),'rp','markerface','r','markersize',12)
box on
axis equal;ylim([-0.5,10]);
%% accuracy calculation
path_length = sum(sqrt(sum((marker(2:end,:)-marker(1:end-1,:)).^2,2)));

% plot(gait_time(1,:),1,'*')
% plot(gait_time(2,:),1,'p')

MS = round((gait_time(1,2:end)-gait_time(2,1:end-1))/2)+gait_time(2,1:end-1);
% plot(MS,1,'v')
FF = [1 MS gait_time(2,end)+5];
pos_FF = pos(FF,1:2);

error_pp = sqrt(sum((pos_FF-marker).^2,2));
error_mean = mean(error_pp);
error_mean/path_length

figure(900);hold on
plot(error_pp)
